{"version":3,"file":"bufollow.min.js","sources":["../../../sources/app.js","../../../sources/controllers/sign.js","../../../sources/services/connect.js","../../../sources/services/sign.js"],"names":["app","angular","module","config","$routeProvider","$locationProvider","$mdThemingProvider","when","controller","templateUrl","controllerAs","otherwise","redirectTo","html5Mode","enabled","requireBase","run","$rootScope","$location","$cookieStore","$http","globals","get","currentUser","defaults","headers","common","authdata","$on","event","next","current","path","ConnectService","SignService","that","this","logout","isRegistering","reset","errorMessage","signInInfo","username","password","signUpInfo","email","switchForm","formsElement","document","querySelector","classList","add","remove","signIn","valid","signin","data","status","statusMessage","signUp","signup","factory","$timeout","login","callback","userData","Base64","encode","userName","Authorization","put","call","success","keyStr","input","chr1","chr2","enc1","enc2","enc3","output","chr3","enc4","i","charCodeAt","isNaN","charAt","length","decode","base64test","exec","window","alert","replace","indexOf","String","fromCharCode","service","user","post","then","response","console","log"],"mappings":"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","sourcesContent":["(function() {\n  'use strict';\n\n  var app = angular.module('app', ['ngRoute', 'ngCookies', 'ngMaterial', 'ngAnimate']);\n\n  app.config(['$routeProvider', '$locationProvider', '$mdThemingProvider', function($routeProvider, $locationProvider, $mdThemingProvider) {\n    $routeProvider\n      .when('/signin', {\n        controller: 'SignController',\n        templateUrl: 'partials/signin',\n        controllerAs: 'vm'\n      })\n      .otherwise({\n        redirectTo: '/'\n      });\n\n    $locationProvider.html5Mode({\n      enabled: true,\n      requireBase: false\n    });\n  }]);\n\n  app.run(['$rootScope', '$location', '$cookieStore', '$http', function run($rootScope, $location, $cookieStore, $http) {\n    // keep user logged in after page refresh\n    $rootScope.globals = $cookieStore.get('globals') || {};\n\n    if ($rootScope.globals.currentUser) {\n      $http.defaults.headers.common['Authorization'] = 'Basic ' + $rootScope.globals.currentUser.authdata; // jshint ignore:line\n    }\n\n    $rootScope.$on('$locationChangeStart', function (event, next, current) {\n      // redirect to login page if not logged in and trying to access a restricted page\n      //var restrictedPage = $.inArray($location.path(), ['/login', '/register']) === -1;\n\n      if (!$rootScope.globals.currentUser) {\n        $location.path('/signin');\n      }\n    });\n  }]);\n})();","(function() {\n  'use strict';\n\n  var app = angular.module('app');\n\n  app.controller('SignController', [\n    '$location', 'ConnectService', 'SignService',\n    function($location, ConnectService, SignService) {\n      var that = this;\n\n      (function initController() {\n        // reset login status\n        SignService.logout();\n      })();\n\n\n      this.isRegistering = false;\n\n      this.reset = function SignController_reset() {\n        this.errorMessage = '';\n        that.signInInfo = {\n          username: '',\n          password: ''\n        };\n\n        that.signUpInfo = {\n          username: '',\n          email: '',\n          password: ''\n        };\n      };\n\n      /**\n       * Display the signin or the signup form\n       */\n      this.switchForm = function SignController_switchForm() {\n        var formsElement = document.querySelector('#buf-sign__forms');\n\n        this.isRegistering = !this.isRegistering;\n\n        if (this.isRegistering) {\n          formsElement.classList.add('registering');\n        } else {\n          formsElement.classList.remove('registering');\n        }\n\n        this.errorMessage = '';\n      };\n\n      this.signIn = function SignController_signIn(valid) {\n        if (valid) {\n          SignService.signin(this.signInInfo, function(data) {\n            if (data.status === 'error') {\n              that.errorMessage = data.statusMessage;\n            } else {\n              that.reset();\n\n              $location.path(\"/\");\n            }\n          });\n        }\n      };\n\n      this.signUp = function SignController_signUp(valid) {\n        if (valid) {\n          SignService.signup(this.signUpInfo, function(data) {\n            if (data.status === 'error') {\n              that.errorMessage = data.statusMessage;\n            } else {\n              that.reset();\n            }\n          });\n        }\n      };\n\n      this.reset();\n    }\n  ]);\n})();","(function() {\n  'use strict';\n\n  angular\n    .module('app')\n    .factory('ConnectService', [\n      '$http', '$cookieStore', '$rootScope', '$timeout', 'SignService',\n      function($http, $cookieStore, $rootScope, $timeout, SignService) {\n        return {\n          login: function(username, password, callback) {\n            var userData = Base64.encode(username + ':' + password);\n\n            $rootScope.globals.currentUser = {\n              userName: username,\n              userData: userData\n            };\n\n            $http.defaults.headers.common.Authorization = 'Basic ' + userData;\n            $cookieStore.put('globals', $rootScope.globals);\n\n            callback.call(this, {\n              success: true\n            });\n          },\n          logout: function() {\n            $rootScope.globals = {};\n            $cookieStore.remove('globals');\n            $http.defaults.headers.common.Authorization = 'Basic ';\n          }\n        };\n      }\n    ]);\n\n  var Base64 = {\n    keyStr: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=',\n    encode: function(input) {\n      var output = '\"\"';\n      var chr1, chr2, chr3 = '\"\"';\n      var enc1, enc2, enc3, enc4 = '\"\"';\n      var i = 0;\n\n      do {\n        chr1 = input.charCodeAt(i++);\n        chr2 = input.charCodeAt(i++);\n        chr3 = input.charCodeAt(i++);\n\n        enc1 = chr1 >> 2;\n        enc2 = ((chr1 & 3) << 4) | (chr2 >> 4);\n        enc3 = ((chr2 & 15) << 2) | (chr3 >> 6);\n        enc4 = chr3 & 63;\n\n        if (isNaN(chr2)) {\n          enc3 = enc4 = 64;\n        } else if (isNaN(chr3)) {\n          enc4 = 64;\n        }\n\n        output = output +\n          this.keyStr.charAt(enc1) +\n          this.keyStr.charAt(enc2) +\n          this.keyStr.charAt(enc3) +\n          this.keyStr.charAt(enc4);\n        chr1 = chr2 = chr3 = '\"\"';\n        enc1 = enc2 = enc3 = enc4 = \"\";\n      } while (i < input.length);\n\n      return output;\n    },\n\n    decode: function(input) {\n      var output = \"\";\n      var chr1, chr2, chr3 = \"\";\n      var enc1, enc2, enc3, enc4 = \"\";\n      var i = 0;\n\n      // remove all characters that are not A-Z, a-z, 0-9, +, /, or =\n      var base64test = /[^A-Za-z0-9\\+\\/\\=]/g;\n      if (base64test.exec(input)) {\n        window.alert(\"There were invalid base64 characters in the input text.\\n\" +\n          \"Valid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='\\n\" +\n          \"Expect errors in decoding.\");\n      }\n      input = input.replace(/[^A-Za-z0-9\\+\\/\\=]/g, \"\");\n\n      do {\n        enc1 = this.keyStr.indexOf(input.charAt(i++));\n        enc2 = this.keyStr.indexOf(input.charAt(i++));\n        enc3 = this.keyStr.indexOf(input.charAt(i++));\n        enc4 = this.keyStr.indexOf(input.charAt(i++));\n\n        chr1 = (enc1 << 2) | (enc2 >> 4);\n        chr2 = ((enc2 & 15) << 4) | (enc3 >> 2);\n        chr3 = ((enc3 & 3) << 6) | enc4;\n\n        output = output + String.fromCharCode(chr1);\n\n        if (enc3 != 64) {\n          output = output + String.fromCharCode(chr2);\n        }\n        if (enc4 != 64) {\n          output = output + String.fromCharCode(chr3);\n        }\n\n        chr1 = chr2 = chr3 = \"\";\n        enc1 = enc2 = enc3 = enc4 = \"\";\n\n      } while (i < input.length);\n\n      return output;\n    }\n  };\n})();","(function() {\n  'use strict';\n\n  angular\n    .module('app')\n    .factory('SignService', ['$http', '$cookieStore', '$rootScope', function($http, $cookieStore, $rootScope) {\n      var service = {};\n\n      service.signup = function SignService_create(user, callback) {\n        $http.post('/api/signup', user).then(function(response) {\n          if (callback) {\n            callback(response.data);\n          }\n        });\n      };\n\n      service.signin = function SignService_create(user, callback) {\n        $http.post('/api/signin', user).then(function(response) {\n          var userData = Base64.encode(user.username + ':' + password);\n\n          $rootScope.globals.currentUser = {\n            userName: user.username,\n            userData: userData\n          };\n\n          $http.defaults.headers.common.Authorization = 'Basic ' + userData;\n          $cookieStore.put('globals', $rootScope.globals);\n\n          console.log($rootScope.globals);\n\n          if (callback) {\n            callback(response.data);\n          }\n        });\n      };\n\n      service.logout = function SignService_logout() {\n        $rootScope.globals = {};\n        $cookieStore.remove('globals');\n        $http.defaults.headers.common.Authorization = 'Basic ';\n      };\n\n      return service;\n    }]);\n\n  var Base64 = {\n    keyStr: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=',\n    encode: function(input) {\n      var output = '\"\"';\n      var chr1, chr2, chr3 = '\"\"';\n      var enc1, enc2, enc3, enc4 = '\"\"';\n      var i = 0;\n\n      do {\n        chr1 = input.charCodeAt(i++);\n        chr2 = input.charCodeAt(i++);\n        chr3 = input.charCodeAt(i++);\n\n        enc1 = chr1 >> 2;\n        enc2 = ((chr1 & 3) << 4) | (chr2 >> 4);\n        enc3 = ((chr2 & 15) << 2) | (chr3 >> 6);\n        enc4 = chr3 & 63;\n\n        if (isNaN(chr2)) {\n          enc3 = enc4 = 64;\n        } else if (isNaN(chr3)) {\n          enc4 = 64;\n        }\n\n        output = output +\n          this.keyStr.charAt(enc1) +\n          this.keyStr.charAt(enc2) +\n          this.keyStr.charAt(enc3) +\n          this.keyStr.charAt(enc4);\n        chr1 = chr2 = chr3 = '\"\"';\n        enc1 = enc2 = enc3 = enc4 = \"\";\n      } while (i < input.length);\n\n      return output;\n    },\n\n    decode: function(input) {\n      var output = \"\";\n      var chr1, chr2, chr3 = \"\";\n      var enc1, enc2, enc3, enc4 = \"\";\n      var i = 0;\n\n      // remove all characters that are not A-Z, a-z, 0-9, +, /, or =\n      var base64test = /[^A-Za-z0-9\\+\\/\\=]/g;\n      if (base64test.exec(input)) {\n        window.alert(\"There were invalid base64 characters in the input text.\\n\" +\n          \"Valid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='\\n\" +\n          \"Expect errors in decoding.\");\n      }\n      input = input.replace(/[^A-Za-z0-9\\+\\/\\=]/g, \"\");\n\n      do {\n        enc1 = this.keyStr.indexOf(input.charAt(i++));\n        enc2 = this.keyStr.indexOf(input.charAt(i++));\n        enc3 = this.keyStr.indexOf(input.charAt(i++));\n        enc4 = this.keyStr.indexOf(input.charAt(i++));\n\n        chr1 = (enc1 << 2) | (enc2 >> 4);\n        chr2 = ((enc2 & 15) << 4) | (enc3 >> 2);\n        chr3 = ((enc3 & 3) << 6) | enc4;\n\n        output = output + String.fromCharCode(chr1);\n\n        if (enc3 != 64) {\n          output = output + String.fromCharCode(chr2);\n        }\n        if (enc4 != 64) {\n          output = output + String.fromCharCode(chr3);\n        }\n\n        chr1 = chr2 = chr3 = \"\";\n        enc1 = enc2 = enc3 = enc4 = \"\";\n\n      } while (i < input.length);\n\n      return output;\n    }\n  };\n})();"]}